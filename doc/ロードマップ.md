# AI経理エージェント開発ロードマップ

本ロードマップは、AI経理エージェントを段階的に開発・育成していくための計画です。初期の単純な自動化から始め、最終的には自律的に学習・成長する汎用的な業務プラットフォームを目指します。

***

[図：4段階のロードマップ。横軸にフェーズ、縦軸に知能/自律性レベルが上昇していく様子]

***

### フェーズ1：PoC（概念実証）- 固定フローによる単一業務の自動化

* **目標:**
    特定の単一業務（交通費精算）を、定義されたツールと固定フローで自動化できることを技術的に証明します。将来の拡張性を見据えた**「ツール化」の基礎**を固めることが主目的です。

* **AIエージェントの振る舞い:**
    この段階のAIは自ら「計画」を立てることはせず、人間が事前にプログラムした**固定のワークフロー**（例：`Excelを読む` → `計算する` → `CSVを書き出す`）を忠実に実行します。

* **主な開発項目:**
    * **最小限のツール群:**
        * `excel_reader`: Excelファイル読み取りツール
        * `sum_calculator`: 合計計算ツール
        * `csv_writer`: CSVファイル書き出しツール
    * **実行エンジン:**
        * ツールを決められた順序で呼び出す、シンプルなプログラムを構築します。
    * **簡易UI:**
        * ユーザーがファイルをアップロードし、処理結果をダウンロードできる最低限のWebインターフェースを用意します。

***

### フェーズ2：プロトタイプ - LLMによる動的プランニングの導入

* **目標:**
    LLM（大規模言語モデル）を本格導入し、AIエージェントが**業務手順書を自ら解釈して、単純な実行計画を立てられる**ようにします。

* **AIエージェントの振る舞い:**
    AIが「指揮者」としての役割を担い始めます。ユーザーの指示と手順書の内容から、「どのツールを、どの順番で使うべきか」を**動的に判断**します。手順書の変更にもある程度追従できるようになります。

* **主な開発項目:**
    * **プランニング機能:**
        * LLMに手順書を読み解かせ、実行計画（ツールのリストと順序）を生成させる機能を実装します（ReAct, Chain of Thought等の技術を活用）。
    * **ツールボックスの拡充:**
        * `ocr_reader`: 領収書等の画像から文字を読み取るツール
        * `human_validator`: 人間への確認・承認を求めるツール
        * `text_formatter`: 摘要欄など、ルールに基づきテキストを整形するツール
    * **対話型UI:**
        * AIの実行計画や確認事項をユーザーに提示し、フィードバックを受け取れるようにUIを改善します。

***

### **フェーズ3：専門家エージェントの導入と実行基盤の確立**

* **ゴール**:
    * 手順書を解釈する監督エージェントが、**固定ロジック型の専門家エージェント**を呼び出すアーキテクチャを確立する。
    * このアーキテクチャに基づき、最初の類似業務（例：在庫データの棚卸照合）を自動化できる状態。
    * 今後の専門家エージェント開発を効率化するための**「汎用ワークフロー」**の基盤が実装されている状態。

* **AIエージェントの振る舞い**:
    * **監督エージェント (`planner`)**: 手順書を読み、「どの専門家エージェントを呼び出すべきか」「突合キーは何か」「検証ルールは何か」といった**実行パラメータを抽出し、構造化データとして整理**します。
    * **専門家エージェント**: 監督エージェントから具体的なパラメータを受け取り、内部に**ハードコードされた固定ロジック**に従って、汎用ツール群を順次呼び出し、特定の業務（在庫照合など）を確実に遂行します。

* **主な開発項目**:
    1.  **汎用照合ワークフローの実装**:
        * 「データ読み込み → 突合 → 検証 → 出力」という照合業務の共通シーケンスを、再利用可能なクラスまたはモジュールとして実装します。
    2.  **最初の専門家エージェント開発**:
        * `InventoryMatchingAgent`（在庫照合エージェント）を、上記の「汎用照合ワークフロー」を利用して開発します。
        * 在庫照合に固有のロジック（数量比較、許容誤差の処理など）を**差分として実装**します。
    3.  **監督エージェントの能力強化**:
        * LLMプロンプトを改良し、手順書からより複雑なパラメータ（JSON形式のルールセット等）を安定して抽出できるようにします。
        * 業務内容に応じて、呼び出すべき専門家エージェントを決定するルーティング機能を追加します。
    4.  **汎用ツールボックスの拡充**:
        * `numeric_field_validator`（許容誤差付き数値検証ツール）や`string_field_validator`（文字列一致検証ツール）など、新しい汎用ツールを`src/tools`に追加します。

---

### **フェーズ4：対応業務の拡大と監督能力の高度化**

* **ゴール**:
    * 「データ照合」領域において、**複数の専門家エージェント（人事名簿突合など）が実装**され、経理担当者が手順書を用意するだけで様々な照合業務を遂行できる状態。
    * 監督エージェントが、手順書の曖昧な記述を解釈し、**複数の汎用ツールや専門家エージェントを組み合わせた、より複雑な実行計画**を立てられるようになっている状態。
    * （理想のB案に向けた布石として）専門家エージェントが、限定的な自己回復能力を持ち始めている。

* **AIエージェントの振る舞い**:
    * **監督エージェント**: より高度な自然言語理解に基づき、手順書に明記されていない暗黙的な指示を補完したり、複数の専門家エージェントを連携させたりする計画を生成します。（例：「在庫照合の結果、差異が出た商品の発注データを調べて」という指示に対し、`InventoryMatchingAgent`と`OrderHistorySearchAgent`を連携させる）
    * **専門家エージェント**: 実行中に発生した軽微なエラー（一時的なファイルアクセス失敗など）を検知し、リトライ処理を自律的に行います。

* **主な開発項目**:
    1.  **専門家エージェントの拡充**:
        * `EmployeeDataValidatorAgent`（人事名簿突合エージェント）などを、「汎用照合ワークフロー」を基盤に次々と開発します。
    2.  **監督エージェントの思考プロセスの強化**:
        * ReAct（Reason-Act）やCoT（Chain of Thought）といった技術を本格導入し、監督エージェントの計画立案能力と透明性を向上させます。
    3.  **限定的な自己回復機能の実装**:
        * 専門家エージェントの基盤となる汎用ワークフローに、リトライや基本的なフォールバックといったエラーハンドリング機構を組み込みます。
    4.  **ツール/エージェント管理基盤 (レジストリ)**:
        * 利用可能な専門家エージェントや汎用ツールの一覧、およびその「AI向け説明」を管理する仕組みを導入し、監督エージェントが動的に参照できるようにします。

---

### **フェーズ5：エコシステム化と自己進化への挑戦**

* **ゴール**:
    * 経理担当者がプログラミング知識なしで、**新しい照合業務のルールをGUIで設定**できる、汎用的なプラットフォーム（エコシステム）が実現している。
    * AIが過去の実行結果と人間のフィードバックから学習し、**判断基準（パラメータ抽出など）の精度を自己改善**させている状態。
    * 一部の業務領域で、**自律実行型（B案）の専門家エージェント**の実証実験が開始されている。

* **AIエージェントの振る舞い**:
    * **監督エージェント**: 人間による過去の修正（例：「この前の在庫照合、突合キーは商品コードじゃなくてJANコードだったよ」というフィードバック）を学習し、次に同様の指示が来た際に、より適切なパラメータを自ら推定・生成します。
    * **経理担当者**: 新しい照合業務が発生した際、管理画面から「人事名簿突合エージェントのテンプレートをコピーし、検証項目だけを変更する」といった操作で、新たな業務プロセスをシステムに適応させます。

* **主な開発項目**:
    1.  **自己改善ループの導入**:
        * 実行ログと人間のフィードバック（修正指示）を収集・分析し、監督エージェントのパラメータ抽出能力を向上させる仕組み（RAGの継続的改善、Few-shotプロンプティングの動的更新など）を導入します。
    2.  **業務設定用UIの開発**:
        * 経理担当者が、専門家エージェントのテンプレートをベースに、検証ルールや入出力ファイル形式などをGUIで設定できる管理画面を構築します。
    3.  **自律実行型エージェント（B案）のPoC**:
        * 十分な学習データと安定性が確保された業務領域（例：最も頻繁に実行される売掛金消込）において、専門家エージェントを自律実行型へ移行させる実証実験を開始します。

---

